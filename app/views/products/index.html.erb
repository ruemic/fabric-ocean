<h1 class="gallery-name"><%= @header_name %> Gallery</h1>

<div id="tag_cloud">
  <% tag_cloud Product.tag_counts, %w[s m l] do |tag, css_class| %>
    <%= link_to tag.name, tag_path(tag.name), class: css_class %>
  <% end %>
</div>

<div id="products">
  <% @products.each do |product| %>
  <div class="product">
    <%= link_to image_tag(product.image_url(:thumb)), product if product.image? %>
    <div class="name"><%= product.name %></div>
    <p>
      Tags: <%= raw product.tag_list.map { |t| link_to t, tag_path(t) }.join(', ') %>
    </p>

    <% current_user.favorites.product.each do |favorite_product| %>
      <% if favorite_product.first.product_id == product.id %>
        <h1> Un favorite</h1>
      <% end %>
    <% end %>

    <div class="fav-it">
      <%= form_tag url_for( :controller => "favorites",
                            :action => "create",
                            :method => "post",
                            :user_id => current_user.id,
                            :product_id => product.id ),
                            :remote => true do %>

        <div class="favorite-it">
          <span class="fav-star">&#9734;</span>
          <%= submit_tag "favorite it!" %>
        </div>
      <% end %>
    </div>

    <div class="actions">
      <%= link_to "edit", edit_product_path(product) %> |
      <%= link_to "remove", product, :method => :delete %>
    </div>
  </div>
  <% end %>
</div>
<div class="clear"></div>
<%= will_paginate @products, previous_label: h("<"), next_label: h(">") %>

<%= form_for Product.new do |f| %>
  <%= f.label :image, "Upload paintings:" %>
  <%= f.file_field :image, multiple:true, name: "product[image]" %>
<% end %>

<script id="template-upload" type="text/x-tmpl">
<div class="upload">
  {%=o.name%}
  <div class="progress"><div class="bar" style="width: 0%"></div></div>
</div>
</script>
